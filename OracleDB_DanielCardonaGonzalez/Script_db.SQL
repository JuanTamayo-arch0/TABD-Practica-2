
CREATE TABLE Ordenes (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    descripcion VARCHAR2(50) NOT NULL UNIQUE
);

CREATE TABLE Modalidades_contratos (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    descripcion VARCHAR2(50) NOT NULL UNIQUE
);

CREATE TABLE Tipos_contratos (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    descripcion VARCHAR2(50) NOT NULL UNIQUE
);

CREATE TABLE Ciudades (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    descripcion VARCHAR2(50) NOT NULL UNIQUE -- Cambiado a único ya que no hay departamentos
);

CREATE TABLE Entidades (
    nit_entidad INT PRIMARY KEY,
    ciudad_id INT NOT NULL,
    orden_id INT NOT NULL,
    centralizada CHAR(1) CHECK (centralizada IN ('S','N')),
    CONSTRAINT fk_entidad_ciudad FOREIGN KEY (ciudad_id)
        REFERENCES Ciudades(id),
    CONSTRAINT fk_entidad_orden FOREIGN KEY (orden_id)
        REFERENCES Ordenes(id)
);

CREATE TABLE Procesos (
    id VARCHAR2(50) PRIMARY KEY,
    fecha DATE NOT NULL,
    precio_base NUMBER(15,2),
    id_modalidad INT NOT NULL,
    duracion INT NOT NULL, -- normalizada a DÍAS
    id_tipo_contrato INT NOT NULL,
    nit_entidad INT NOT NULL,
    CONSTRAINT fk_proceso_modalidad FOREIGN KEY (id_modalidad)
        REFERENCES Modalidades_contratos(id),
    CONSTRAINT fk_proceso_tipo FOREIGN KEY (id_tipo_contrato)
        REFERENCES Tipos_contratos(id),
    CONSTRAINT fk_proceso_entidad FOREIGN KEY (nit_entidad)
        REFERENCES Entidades(nit_entidad)
);

-- TABLA ESQUEMA SIN CORREGIR 

CREATE TABLE esquema_sin_corregir (
    nit_entidad           VARCHAR2(50),
    ciudad_entidad        VARCHAR2(100), -- Se eliminó departamento_entidad
    orden_entidad         VARCHAR2(50),
    entidad_centralizada  VARCHAR2(50),
    id_proceso            VARCHAR2(100),
    fecha_proceso         VARCHAR2(50),
    precio_base           VARCHAR2(100),
    modalidad_contratacion VARCHAR2(200),
    duracion              VARCHAR2(50),
    unidad_duracion       VARCHAR2(50),
    tipo_contrato         VARCHAR2(200)
);
